pipeline {
    agent any

    stages {

        stage ("Verify ðŸ‘€") {
            steps {
                echo $GIT_CHECKOUT_DIR
                echo $BRANCH_NAME
                echo $WORKSPACE_TMP
                echo $WORKSPACE
            }
        }

        stage("Test ðŸ§ª") {
            steps {
                echo "$PWD"
                sh "ls"
                sh "git branch"

                echo "Lancement des tests BACK"
                sh "cd ${WORKSPACE}"
                sh "ls"
                echo "$PWD"
                sh "mvn test"

                echo "Lancement des tests FRONT"
                sh "cd ../proto-front"
                sh "npm test"
            }
        }

        stage("Package ðŸ“¦") {
            steps {
                echo "Compilation du FRONT"
                sh "npm run build"

                echo "Compilation du BACK"
                sh "cd ../proto-back"
                sh "mvn compile"
            }
        }

        stage("Deliver ðŸšš") {
            steps {
                echo "Livraison des fichiers (WIP)"
                sh "cd .."
                sh "scripts/deploy.sh"
            }
        }

        stage("Start ðŸš€") {
            steps {
                sh "scripts/start.sh"
            }
        }
    }
}